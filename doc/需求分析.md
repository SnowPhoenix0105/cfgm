## 需求

1. 作为开源项目，为了保证安全性，部分参数（如数据库密码等）不宜进行硬编码，最好以配置文件的方式进行配置，并且最好配置能够方便一些；
2. 配置文件实现了程序和配置的分离，但是这种分离导致编写配置文件的时候，往往不够方便，很容易出现配置项拼写错误，最好能够由程序来生成配置项（虽然有IDE的支持可能更好）；
3. 我们希望配置文件中的配置项和程序中的某个配置对象能够直接进行映射，而不需要对一个个int/string进行映射，这样我们可以批量地进行文件和配置对象的映射；
4. 有时我们希望通过命令行指定一些配置，命令行的配置应当能够覆盖配置文件的配置；
5. 不仅程序需要配置，有些类库也需要进行配置。我们也希望有一种机制，能够让类库开发者能够直接与程序的配置文件进行交互；

## 场景拆解

### 场景一、程序开发者

对于程序开发者，其主要从程序端进行设计，主要诉求在于：

1. 方便。创建一个配置对象，然后将该对象绑定到某个命名配置项下，对该命名配置项进行的配置能够方便地映射到配置对象中；
2. 默认配置。配置对象的各个字段应该可以指定默认值；
3. 类型约束。开发者可以选择严格地类型匹配，比如int必须匹配一个数字，不可以匹配数字的字符串，也可以选择进行不严格的匹配，例如false可以绑定到int类型，值为0；
4. 配置检查。开发者可以设计某些配置项是必须提供的，或者进行自定义检查；

除此之外还有一些次要的需求：

1. 启动速度快。不希望在配置生效过程耽误过多时间；

### 场景二、类库开发者

类库开发者在程序开发者的需求上，还有一些额外的需求：

1. 注册透明。类库开发者可以在类库的初始化过程中进行类库配置对象与配置文件的绑定，这个过程不需要类库使用者介入；

### 场景三、使用者（运维）

对于使用者，主要操作对象是配置文件，其主要诉求在于：

1. 配置文件模板生成。应当可以生成一个带有默认值的配置文件模板，只需要对该模板中需要修改的地方进行修改即可使用；
2. 配置文件模板分级。在生成配置模板的时候，我们希望可以指定配置的等级，比如生成的模板中只包含必须配置的项（其它项也可以手动添加）；
3. 配置文件支持不同的格式。JSON、YAML、XML等格式最好都能够支持；
4. 可以在命令行中指定配置文件的位置；

此外还有一些次要需求：

1. 无用配置告警。当一个配置文件中的配置项没有被使用到时，很有可能发生了拼写错误，最好能够给出报警；
2. 配置文件语法扩展。JSON格式不支持注释，但是我们希望能够扩展JSON文法使得注释可以被支持；





